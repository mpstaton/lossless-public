---
import fs from "node:fs";
import path from "node:path";

// Get all trademark SVGs
const componentsDir = path.join(
  process.cwd(),
  "src/assets/Visuals/Standardized-Tooling-Trademarks"
);

const trademarks = fs
  .readdirSync(componentsDir)
  .filter((file) => file.endsWith(".svg"))
  .sort(() => Math.random() - 0.5)
  .map((filename) => {
    const content = fs.readFileSync(path.join(componentsDir, filename), "utf8");
    // Extract SVG and modify its attributes
    const svgMatch = content.match(/<svg[^>]*>[\s\S]*?<\/svg>/i);
    if (svgMatch) {
      return svgMatch[0]
        .replace(/height="[^"]*"/, 'height="100%"')
        .replace(/width="[^"]*"/, "auto");
    }
    return "";
  })
  .filter(Boolean);
---

<div class="trademark-ribbon">
  <div class="ribbon-track">
    {
      trademarks.map((svg) => (
        <div class="trademark-container" set:html={svg} />
      ))
    }
    {/* Duplicate for seamless loop */}
    {
      trademarks.map((svg) => (
        <div class="trademark-container" set:html={svg} />
      ))
    }
  </div>
</div>

<style>
  .trademark-ribbon {
    width: 100%;
    height: 160px;
    overflow: visible;
    position: relative;
    background: transparent;
  }

  .ribbon-track {
    display: flex;
    align-items: center;
    animation: scroll 460s linear infinite;
    width: max-content;
    height: 100%;
    gap: 2rem;
  }

  .trademark-container {
    height: 160px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .trademark-container :global(svg) {
    height: 160px;
    width: auto;
    max-width: none;
    display: block;
  }

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .ribbon-track {
      animation: none;
    }
  }
</style>
